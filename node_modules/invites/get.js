const ObjectId = require("mongodb").ObjectId;
const channel = require("class/channel.js");

module.exports = async (session, message) => {
    if (await session.set()) {
        const { guild_id } = message;

        if (await channel.isOwner(guild_id, session.user_id)) {
            const db = await require("class/database.js");
            const results = await db.collection("invites").find({ guild_id: ObjectId(guild_id) }).toArray();

            const array = [];
            for (let result of results) {
                array.push(result._id);
            }

            return {
                status: true,
                invites: array
            }
        } else {
            return {
                status: false,
                error: "Missing permissions"
            }
        }
    } else {
        return {
            status: false
        }
    }
}